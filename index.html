<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>esp32-warm-water: warm water in esp-idf</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">esp32-warm-water
   </div>
   <div id="projectbrief">esp32 based project for the control of a heating element based on temperature</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">warm water in esp-idf </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__home_runner_work_esp32_warm_water_esp32_warm_water_README"></a> <a href="https://docs.espressif.com/projects/esp-idf/en/stable/get-started/"><img src="https://img.shields.io/badge/esp--idf-v4.3%2B-blue.svg" alt="Platform: ESP-IDF" style="pointer-events: none;" class="inline"/></a> <img src="https://img.shields.io/github/workflow/status/wolffshots/esp32-warm-water/doxygen?label=doxygen" alt="GitHub Docs Workflow Status" class="inline"/> <img src="https://img.shields.io/github/workflow/status/wolffshots/esp32-warm-water/codeql?label=codeql/build" alt="GitHub CodeQL Workflow Status" class="inline"/> <img src="https://img.shields.io/github/license/wolffshots/esp32-warm-water" alt="GitHub" class="inline"/> <img src="https://img.shields.io/github/languages/code-size/wolffshots/esp32-warm-water" alt="GitHub code size in bytes" class="inline"/> <img src="https://img.shields.io/github/repo-size/wolffshots/esp32-warm-water" alt="GitHub repo size" class="inline"/> <img src="https://img.shields.io/tokei/lines/github/wolffshots/esp32-warm-water" alt="Lines of code" class="inline"/> <img src="https://img.shields.io/github/v/tag/wolffshots/esp32-warm-water" alt="GitHub tag (latest by date)" class="inline"/></p>
<p>esp-idf implementation of temperature controlled relay to switch a heating element to maintain water in a specific temperature range. A webserver is used to interface with the system and change the goal temperature, range from the goal and the relay state (forced on or off).</p>
<p>employs wifi, onewire and a relay to control the temperature of a body of water for the purpose of film development primarily. other uses include cooking and general chemistry.</p>
<p>the main motivation to do this project was to be able to better process c41 colour film.</p>
<h1><a class="anchor" id="autotoc_md74"></a>
how to use project</h1>
<p>this project is built using the Visual Studio Code esp-idf plugin.</p>
<p>configure it from command line using <code>idf.py</code> or by using the cog in the plugin.</p>
<p>once it is configured, select the correct port of your ESP32 module and build and upload to it.</p>
<p>an explanation of the hardware setup will come at a later stage.</p>
<h1><a class="anchor" id="autotoc_md75"></a>
frontend files</h1>
<p>the files in the <code>front/build</code> directory are for displaying via the webserver and are sort of a separate entity from the rest of the code.</p>
<p>they automatically get made into an image but don't seem to flash with the vscode extension buttons (as a result you may need to run <code>idf.py -p PORT flash</code> for changes to persist).</p>
<p>the frontend can be coded in whatever framework you want as long as you can get it built into a flat file structure (all in one directory without subdirectories). i am partial to vanilla html, css and javascript but there are plenty of lightweight frameworks (like <a href="https://svelte.dev/">svelte</a> and <a href="https://preactjs.com/">preact</a>).</p>
<p>any file in <code>front/build</code> should get flashed to <code>/spiffs</code> but ensure that the <code>front/build</code> directory doens't exceed the size of the <code>/spiffs</code> partition (default 960KB).</p>
<ul>
<li><code>/</code> - the root path which serves <code>index.html</code></li>
<li><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>add more reserved locations here</dd></dl>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md76"></a>
dependencies</h1>
<ul>
<li>esp32-ds18b20 - <a href="https://github.com/wolffshots/esp32-ds18b20">github</a> - <a href="https://gitlab.com/wolffshots/esp32-ds18b20">gitlab</a> - <a href="https://wolffshots.github.io/esp32-ds18b20/index.html">docs</a></li>
<li>esp32-gpio - <a href="https://github.com/wolffshots/esp32-gpio">github</a> - <a href="https://gitlab.com/wolffshots/esp32-gpio">gitlab</a> - <a href="https://wolffshots.github.io/esp32-gpio/index.html">docs</a></li>
<li>esp32-owb - <a href="https://github.com/wolffshots/esp32-owb">github</a> - <a href="https://gitlab.com/wolffshots/esp32-owb">gitlab</a> - <a href="https://wolffshots.github.io/esp32-owb/index.html">docs</a></li>
<li>esp32-ssd1306 - <a href="https://github.com/wolffshots/esp32-ssd1306">github</a> - <a href="https://gitlab.com/wolffshots/esp32-ssd1306">gitlab</a> - <a href="https://wolffshots.github.io/esp32-ssd1306/index.html">docs</a></li>
<li>esp32-utility - <a href="https://github.com/wolffshots/esp32-utility">github</a> - <a href="https://gitlab.com/wolffshots/esp32-utility">gitlab</a> - <a href="https://wolffshots.github.io/esp32-utility/index.html">docs</a></li>
<li>esp32-wifi - <a href="https://github.com/wolffshots/esp32-wifi">github</a> - <a href="https://gitlab.com/wolffshots/esp32-wifi">gitlab</a> - <a href="https://wolffshots.github.io/esp32-wifi/index.html">docs</a></li>
<li>esp32-timer - <a href="https://github.com/wolffshots/esp32-timer">github</a> - <a href="https://gitlab.com/wolffshots/esp32-timer">gitlab</a> - <a href="https://wolffshots.github.io/esp32-timer/index.html">docs</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md77"></a>
folder contents</h1>
<p>the project <b>esp32-warm-water</b> contains one source file in C language <a href="main/main.c">main.c</a>. the file is located in folder [main](main).</p>
<p>esp-idf projects are build using cmake. the project build configuration is contained in <code>CMakeLists.txt</code> files that provide set of directives and instructions describing the project's source files and targets (executable, library, or both).</p>
<p>below is short explanation of remaining files in the project folder.</p>
<div class="fragment"><div class="line">├── components                  the extra components employed in this project</div>
<div class="line">|   ├── esp32-ds18b20           used to interface with the temperature sensor (includes wrapper)</div>
<div class="line">|   ├── esp32-gpio              little gpio wrapper to simplify setup</div>
<div class="line">|   ├── esp32-owb               enables use of the one wire bus protocol</div>
<div class="line">|   ├── esp32-ssd1306           led interface library</div>
<div class="line">|   ├── esp32-utility           some extra helper functions for debugging and qol</div>
<div class="line">|   └── esp32-wifi              some wrappers for the esp wifi functions</div>
<div class="line">├── main                        main component</div>
<div class="line">│   ├── CMakeLists.txt          specific component cmake file</div>
<div class="line">│   ├── component.mk            component make file</div>
<div class="line">│   ├── Kconfig.projbuild       kconfig description file to add build time vars</div>
<div class="line">│   └── main.c                  core src file of the project (client code)</div>
<div class="line">├── .gitignore                  describes what files and folders git should ignore</div>
<div class="line">├── .gitmodules                 describes the sources and paths of the modules used in `/components`</div>
<div class="line">├── CMakeLists.txt              base project cmake file</div>
<div class="line">├── LICENSE.md                  MIT license file</div>
<div class="line">├── Makefile                    makefile used by legacy GNU Make</div>
<div class="line">└── README.md                   this file</div>
</div><!-- fragment --><p>for more information on structure and contents of esp-idf projects, please refer to Section <a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-guides/build-system.html">Build System</a> of the esp-idf programming guide.</p>
<h1><a class="anchor" id="autotoc_md78"></a>
documentation</h1>
<p>automatically generated API documentation (doxygen) is available <a href="https://wolffshots.github.io/esp32-warm-water/index.html">here</a>.</p>
<h1><a class="anchor" id="autotoc_md79"></a>
license</h1>
<p>the code in this project is licensed under the MIT license - see <a class="el" href="md__home_runner_work_esp32_warm_water_esp32_warm_water__l_i_c_e_n_s_e.html">LICENSE</a> for details.</p>
<h1><a class="anchor" id="autotoc_md80"></a>
troubleshooting</h1>
<ul>
<li>program upload failure<ul>
<li>hardware connection is not correct: run <code>idf.py -p PORT monitor</code>, and reboot your board to see if there are any output logs.</li>
<li>the baud rate for downloading is too high: lower your baud rate in the <code>menuconfig</code> menu, and try again.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md81"></a>
helpful commands</h1>
<ul>
<li><code>git submodule update --remote --recursive</code> - updates the checked out modules to the most recent commit to their main branch</li>
<li><code>git push all</code> - as setup with <code><a href="https://jigarius.com/blog/multiple-git-remote-repositories">https://jigarius.com/blog/multiple-git-remote-repositories</a></code></li>
</ul>
<h2><a class="anchor" id="autotoc_md82"></a>
acknowledgements</h2>
<ul>
<li>a big thank you to <a href="https://github.com/DavidAntliff/">David Antliff</a> for providing his fantastic onewire and ds18b20 libraries on github under the MIT license</li>
<li>thanks to <a href="https://github.com/ShirkyBooi">Shirkybooi</a> for pushing me to use esp-idf</li>
<li>last but not least, thanks to <a href="https://github.com/grabt234">Grabt234</a> for helping me get into this field</li>
<li>"1-Wire" is a registered trademark of Maxim Integrated.</li>
<li><a href="https://www.hackster.io/brian-lough">brian-lough</a> for <a href="https://www.hackster.io/brian-lough/3-simple-ways-of-programming-an-esp8266-12x-module-c514ee">this</a> simple but helpful post and linked to <a href="https://github.com/espressif/esptool/wiki/ESP32-Boot-Mode-Selection">this</a> for boot mode selection</li>
</ul>
<h1><a class="anchor" id="autotoc_md83"></a>
todo</h1>
<ul>
<li>[x] timer for temp reads</li>
<li>[x] implement general gpio (built in led) - <a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/gpio.html">https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/gpio.html</a></li>
<li>[x] implement owb</li>
<li>[x] implement ds18b20 - <a href="https://github.com/DavidAntliff/esp32-ds18b20-example">https://github.com/DavidAntliff/esp32-ds18b20-example</a></li>
<li>[x] cleanup wifi component</li>
<li>[x] cleanup readmes</li>
<li>[x] goal temp</li>
<li>[x] margins for goal temp</li>
<li>[x] spiffs!</li>
<li>[x] webserver/url handling - <a href="https://github.com/espressif/esp-idf/tree/master/examples/protocols/http_server/file_serving">https://github.com/espressif/esp-idf/tree/master/examples/protocols/http_server/file_serving</a></li>
<li>[x] implement build testing - <a href="https://calinradoni.github.io/pages/200203-travisci-esp-idf.html">https://calinradoni.github.io/pages/200203-travisci-esp-idf.html</a></li>
<li>[x] make frontend into own git module </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
